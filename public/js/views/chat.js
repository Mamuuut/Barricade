// Generated by CoffeeScript 1.3.3
(function() {

  define(['backbone'], function(Backbone) {
    var ChatView;
    ChatView = Backbone.View.extend({
      el: $("#chat"),
      chatSocket: null,
      template: _.template($('#chat-template').html()),
      initialize: function() {
        var _this = this;
        this.chatSocket = io.connect('/chat');
        this.chatSocket.on('connect', function() {
          return _this.chatSocket.emit('new user', _this.options.user);
        });
        return this.chatSocket.on('new message', function(userMessage) {
          var newMessage;
          newMessage = $(_this.template(userMessage));
          _this.$('#conversation').prepend(newMessage);
          return setTimeout(function() {
            return newMessage.addClass('visible', 0);
          });
        });
      },
      events: {
        "click .switch": "switchSize",
        "keypress #new_message": "keyPressed"
      },
      render: function() {
        return {};
      },
      play: function(game) {
        return {};
      },
      switchSize: function() {
        return this.$el.toggleClass('minimized');
      },
      keyPressed: function(e) {
        var message;
        if (e.which === 13) {
          message = this.$('#new_message').val();
          this.$('#new_message').val('');
          return this.chatSocket.emit('send message', message);
        }
      }
    });
    return ChatView;
  });

}).call(this);
